<!DOCTYPE html>
<html>
<head>
<title>Bhagavad Gita</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<meta name="viewport" content="width=device-width, initial-scale=1.0"/> 
<style>
body {
	font-family: 'Roboto', sans-serif;
    -webkit-touch-callout: none; 
    -webkit-user-select: none; 
     -khtml-user-select: none; 
       -moz-user-select: none; 
        -ms-user-select: none; 
            user-select: none; 
}
table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}

body {
	font-size: 24px;
}

h1 {
	font-size: 34px;
}

select {
	font-size: calc(1em - 4px);
}

option { text-align: right; }
.leftsel { text-align-last: left;}


html {
    position: relative;
    min-height: 100%;
}
.footerWrap {
    width: 100%;
    bottom: 0;
    padding-right: 5px;
}
</style>
</head>
<body>
<div id="chapterstest" style="display: block;">
<h1>Bhagavad Gita</h1>
<hr>
<form action="javascript:getchapter()">
  <label for="chapter">Chapter:&nbsp;</label>
  <select id="chapter" name="chapter" style="font-family: inherit;">
  	<option value="" selected disabled hidden  style="text-align: left;">Choose</option>
    <!-- <option value="dhyana" style="text-align: left;">Dhyana Shlokas</option> -->
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="6">6</option>
    <option value="7">7</option>
    <option value="8">8</option>
    <option value="9">9</option>
    <option value="10">10</option>
    <option value="11">11</option>
    <option value="12">12</option>
    <option value="13">13</option>
    <option value="14">14</option>
    <option value="15">15</option>
    <option value="16">16</option>
    <option value="17">17</option>
    <option value="18">18</option>
  </select>
</form>
</div>

<div style="display: none;" id="shlokasting"><br>
        <form action="javascript:getshloka()">
  <label for="test">Shloka:&nbsp;</label>
  <select id="shloka" name="test" style="font-family: inherit;">  
  <option value="" selected disabled hidden>Choose</option>
  </select><br><br>
  <a href="javascript:getall()">Full Script</a>&nbsp;&nbsp;<a href="javascript:fullaudio()">Full Audio</a>
  </form>
  <div id="invisible-audio">
  
  </div>
        <!-- footer -->
        
        <footer class="footerWrap"><hr><a href="/mobile">Go home</a></footer>
</div>








<div style="display: none;" id="finalshloka">
<h1>Chapter <span id="chapteradd1"></span>, Shloka <span id="shlokadd"></span></h1>

<hr>

<div id="theshloka">
Loading... Please wait
</div>
<div id="themeaning">

</div>



<!-- footer -->
        <footer class="footerWrap"><hr><a href="/mobile">Go home</a><br>

        	<a href="javascript:gotoback()">Previous</a><span> </span><a href="javascript:gottofront()" style="float: right;">Next</a></footer>
</div>

<div style="display: none;" id="fullchapter">
<h1>Chapter <span id="chapteradd2"></span>, Full Chapter</h1><hr>
<div id="theshlokas">
Loading... Please wait
</div>

<!-- footer -->
        
        <footer class="footerWrap"><hr><a href="/mobile">Go home</a></footer>
</div>

<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="arjakkipally" data-description="Support me on Buy me a coffee!" data-message="" data-color="#5F7FFF" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

<script>
function fullaudio() {
	document.getElementById("invisible-audio").innerHTML = `
	<audio controls>
	<source src="https://bhagavdgita.github.io/audio/full.${document.getElementById("chapter").value}.m4a" type="audio/x-m4a">
  <code> Your phone doesn't support audio tags</code>
</audio>
    `
}


var e = document.getElementById("chapter");
function onChange() {
  var value = e.value;
  var text = e.options[e.selectedIndex].text;
  console.log(value);
  getchapter();
}
e.onchange = onChange;


var chapter = ""
function getchapter() {
	
    
    extras = ["dhyana"]
    
    
    if (extras.includes(document.getElementById("chapter").value)) {
    
    
    } else {
    
	var chapter = document.getElementById("chapter").value
    var listshlokas = ["0", "47", "72", "43", "42", "29", "47", "30", "28", "34", "42", "55", "20", "35", "27", "20", "24", "28", "78"]
    	document.getElementById("chapterstest").style = "display: block;"
    	document.getElementById("shlokasting").style = "display: block;"
        for (var i = 1; i < parseInt(listshlokas[chapter]) + 1; i++) {
          createnewoption = document.createElement("option")
          createnewoption.innerHTML = i.toString()
          createnewoption.value = i.toString()
          test = document.getElementById("shloka")
          test.appendChild(createnewoption)
        }
     document.getElementById("chapter").setAttribute("disabled", "")
     var e = document.getElementById("shloka");
function onChange() {
  var value = e.value;
  var text = e.options[e.selectedIndex].text;
  console.log(value);
  getshloka();
}
e.onchange = onChange;
}
}



function getall() {
var shloka = document.getElementById("shloka").value
document.getElementById("shlokasting").style = "display: none;"
    document.getElementById("chapterstest").style = "display: none;"
    document.getElementById("fullchapter").style = "display: block;"
    	document.getElementById("chapteradd2").innerHTML = document.getElementById("chapter").value
    const options = {
	method: 'GET',
	headers: {
		'X-RapidAPI-Key': '72ddb23f61mshd7034341804bcedp12906djsned505dec18e5',
		'X-RapidAPI-Host': 'bhagavad-gita3.p.rapidapi.com'
	}
};

fetch('https://bhagavad-gita3.p.rapidapi.com/v2/chapters/' + document.getElementById("chapter").value + '/verses/', options)
	.then(response => response.json())
	.then(response => {
    	var result = ""
    	response.forEach(item => {
        	result = result + item.transliteration.replaceAll('\n', '<br>')
            result = result + "<br><br>"
        })
        document.getElementById("theshlokas").innerHTML = result
    })
	.catch(err => console.error(err));
}

function getshloka() {

	var shloka = document.getElementById("shloka").value
    
    if (shloka == "all") {
    
    
    
    getall()
    
    
    
    
    } else {
    
    document.getElementById("shlokasting").style = "display: none;"
    document.getElementById("chapterstest").style = "display: none;"
    document.getElementById("finalshloka").style = "display: block;"
    document.getElementById("chapteradd1").innerHTML = document.getElementById("chapter").value
    document.getElementById("shlokadd").innerHTML = shloka
    
    // get shloka from api

    const options = {
	method: 'GET',
	headers: {
		'X-RapidAPI-Key': '72ddb23f61mshd7034341804bcedp12906djsned505dec18e5',
		'X-RapidAPI-Host': 'bhagavad-gita3.p.rapidapi.com'
	}
};

fetch('https://bhagavad-gita3.p.rapidapi.com/v2/chapters/' + document.getElementById("chapter").value + '/verses/' + shloka + '/', options)
	.then(response => response.json())
	.then(response => {
    document.getElementById("theshloka").innerHTML = response.transliteration.replaceAll('\n', '<br>')
    document.getElementById("themeaning").innerHTML = "<br><br>" +  response.translations[0].description.replaceAll('\n', '<br>') + `<br>
<audio controls>
	<source src="https://bhagavdgita.github.io/audio/${document.getElementById("chapter").value}.${shloka}.m4a" type="audio/x-m4a">
  <code> Your phone doesn't support audio tags</code>
</audio>`
    })
	.catch(err => console.error(err));
    }
} 


function gotoback() {
	var listshlokas = ["0", "47", "72", "43", "42", "29", "47", "30", "28", "34", "42", "55", "20", "35", "27", "20", "24", "28", "78"]
	var shloka = document.getElementById("shloka").value
    var chapter = document.getElementById("chapter").value
    document.getElementById("theshloka").innerHTML = "Loading... Please wait"
    document.getElementById("themeaning").innerHTML = ""
    if (shloka == 1) {
    	document.getElementById("shloka").value = listshlokas[parseInt(chapter) - 1]
        document.getElementById("chapter").value = parseInt(chapter) - 1
        console.log(document.getElementById("chapter").value)
        console.log(document.getElementById("shloka").value)
        getshloka()
    } else {
    	document.getElementById("shloka").value = parseInt(shloka) - 1
        getshloka()
    }
}

function gottofront() {
	var listshlokas = ["0", "47", "72", "43", "42", "29", "47", "30", "28", "34", "42", "55", "20", "35", "27", "20", "24", "28", "78"]
	var shloka = document.getElementById("shloka").value
    var chapter = document.getElementById("chapter").value
    document.getElementById("theshloka").innerHTML = "Loading... Please wait"
    document.getElementById("themeaning").innerHTML = ""
    if (shloka == parseInt(listshlokas[chapter])) {
    	document.getElementById("shloka").value = 1
        document.getElementById("chapter").value = parseInt(chapter) + 1
        console.log(document.getElementById("chapter").value)
        console.log(document.getElementById("shloka").value)
        getshloka()
    } else {
    	document.getElementById("shloka").value = parseInt(shloka) + 1
        getshloka()
    }
}
</script>
</body>
</html>
